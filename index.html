<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¸›ç‚¹è¦ç´ ä»˜ãï¼ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¹ãƒŠãƒƒãƒ—</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Segoe UI', sans-serif;
            background-color: #222;
            color: white;
            margin: 0;
            padding-top: 20px;
        }

        h1 {
            color: #ffcc00;
        }

        #gameArea {
            width: 80vw;
            height: 60vh;
            border: 5px solid #ffcc00;
            position: relative;
            background-color: #333;
            margin: 20px 0;
            overflow: hidden;
            cursor: crosshair;
        }

        /* ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå…±é€šã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .character {
            position: absolute;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            cursor: pointer;
            user-select: none;
            transition: transform 0.1s, box-shadow 0.1s;
        }

        /* ã‚¯ãƒªãƒƒã‚¯ã—ã¦è‰¯ã„ã‚­ãƒ£ãƒ© (ã‚°ãƒƒãƒ‰ã‚­ãƒ£ãƒ©) */
        .good {
            background-color: #f0f8ff; /* è–„ã„é’ */
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.7); /* é’ãå…‰ã‚‹ */
        }
        .good:hover {
            transform: scale(1.05);
        }
        .good:active {
            transform: scale(0.95);
            background-color: #ffeb3b;
            box-shadow: 0 0 5px rgba(255, 255, 0, 0.9);
        }

        /* ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã¯ã„ã‘ãªã„ã‚­ãƒ£ãƒ© (ãƒãƒƒãƒ‰ã‚­ãƒ£ãƒ©) */
        .bad {
            background-color: #ff7f50; /* ã‚µãƒ³ã‚´è‰² */
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7); /* èµ¤ãå…‰ã‚‹ */
        }
        .bad:hover {
            transform: scale(1.05);
        }
        .bad:active {
            transform: scale(0.95);
            background-color: #c70039;
            box-shadow: 0 0 5px rgba(255, 0, 0, 0.9);
        }

        #infoDisplay {
            font-size: 1.5em;
            margin-bottom: 10px;
            color: #ccffcc;
        }

        #startButton {
            padding: 12px 25px;
            font-size: 1.3em;
            background-color: #ffcc00;
            color: #333;
            font-weight: bold;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            box-shadow: 0 4px #e6b800;
            transition: transform 0.1s, box-shadow 0.1s;
        }

        #startButton:active {
            transform: translateY(2px);
            box-shadow: 0 2px #ccaa00;
        }

        #startButton:disabled {
            background-color: #888;
            color: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }
    </style>
</head>
<body>
    <h1>âŒ ã‚°ãƒƒãƒ‰ã‚­ãƒ£ãƒ©ã ã‘ã‚’ç‹™ãˆï¼ âŒ</h1>

    <div id="infoDisplay">
        <span id="scoreDisplay">ã‚¹ã‚³ã‚¢: 0</span> | 
        <span id="timerDisplay">æ®‹ã‚Šæ™‚é–“: 10.00ç§’</span>
    </div>

    <button id="startButton">ã‚²ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>

    <div id="gameArea">
        </div>

    <script>
        // ã‚²ãƒ¼ãƒ è¨­å®š
        const GAME_DURATION = 10; // åˆ¶é™æ™‚é–“ (ç§’)
        const SPAWN_INTERVAL = 1000; // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®å‡ºç¾é–“éš” (ãƒŸãƒªç§’)
        const CHARACTER_LIFETIME = 1500; // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãŒæ¶ˆãˆã‚‹ã¾ã§ã®æ™‚é–“ (ãƒŸãƒªç§’)
        const MAX_CHARACTERS = 5; // ç”»é¢ä¸Šã«åŒæ™‚ã«å­˜åœ¨ã™ã‚‹æœ€å¤§ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ•°

        const GOOD_EMOJIS = ['ğŸ˜Š', 'ğŸ˜', 'ğŸ¤©', 'ğŸ¥³', 'ğŸ˜‡']; // ã‚¯ãƒªãƒƒã‚¯ã§åŠ ç‚¹
        const BAD_EMOJIS = ['ğŸ˜ ', 'ğŸ˜«', 'ğŸ˜©', 'ğŸ˜µ', 'ğŸ˜±']; // ã‚¯ãƒªãƒƒã‚¯ã§æ¸›ç‚¹

        // HTMLè¦ç´ ã®å‚ç…§
        const scoreDisplay = document.getElementById('scoreDisplay');
        const timerDisplay = document.getElementById('timerDisplay');
        const startButton = document.getElementById('startButton');
        const gameArea = document.getElementById('gameArea');

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹å¤‰æ•°
        let score = 0;
        let timeLeft = GAME_DURATION;
        let gameActive = false;
        let timerInterval;
        let spawnInterval;
        let characterIdCounter = 0;

        // ------------------
        // é–¢æ•°å®šç¾©
        // ------------------

        /**
         * ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ãƒ©ãƒ³ãƒ€ãƒ ãªä½ç½®ã«ç”Ÿæˆã™ã‚‹
         */
        function spawnCharacter() {
            if (!gameActive) return;

            // ç”»é¢ä¸Šã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼æ•°ãŒä¸Šé™ã‚’è¶…ãˆã¦ã„ãŸã‚‰ç”Ÿæˆã—ãªã„
            if (gameArea.children.length >= MAX_CHARACTERS) return;

            // è‰¯ã„ã‚­ãƒ£ãƒ©ï¼ˆ70%ï¼‰ã‹æ‚ªã„ã‚­ãƒ£ãƒ©ï¼ˆ30%ï¼‰ã‹ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«æ±ºå®š
            const isGood = Math.random() < 0.7;
            const emojiList = isGood ? GOOD_EMOJIS : BAD_EMOJIS;
            const characterType = isGood ? 'good' : 'bad';
            
            // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¦ç´ ã®ä½œæˆ
            const character = document.createElement('div');
            character.className = `character ${characterType}`;
            character.id = `char-${characterIdCounter++}`;
            character.textContent = emojiList[Math.floor(Math.random() * emojiList.length)];
            
            // ãƒ©ãƒ³ãƒ€ãƒ ãªä½ç½®ã‚’è¨ˆç®—
            const charSize = 70; // CSSã§è¨­å®šã—ãŸã‚µã‚¤ã‚º
            const areaWidth = gameArea.clientWidth;
            const areaHeight = gameArea.clientHeight;
            const newX = Math.random() * (areaWidth - charSize);
            const newY = Math.random() * (areaHeight - charSize);

            character.style.left = `${newX}px`;
            character.style.top = `${newY}px`;

            // ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
            character.addEventListener('click', handleCharacterClick);

            // ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ã«è¿½åŠ 
            gameArea.appendChild(character);

            // ä¸€å®šæ™‚é–“å¾Œã«è‡ªå‹•çš„ã«æ¶ˆãˆã‚‹ã‚ˆã†ã«è¨­å®š
            setTimeout(() => {
                if (gameArea.contains(character)) {
                    // æ¶ˆãˆã‚‹æ™‚ã«ãƒšãƒŠãƒ«ãƒ†ã‚£ã¯ä¸ãˆãªã„
                    gameArea.removeChild(character);
                }
            }, CHARACTER_LIFETIME);
        }

        /**
         * æ™‚é–“ã‚’ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã—ã€ã‚²ãƒ¼ãƒ çµ‚äº†ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹
         */
        function countdown() {
            timeLeft -= 0.01;
            
            if (timeLeft <= 0) {
                timeLeft = 0;
                endGame();
            }

            timerDisplay.textContent = `æ®‹ã‚Šæ™‚é–“: ${timeLeft.toFixed(2)}ç§’`;
        }

        /**
         * ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
         */
        function handleCharacterClick(event) {
            if (!gameActive) return;

            const targetChar = event.target;
            const isGood = targetChar.classList.contains('good');

            if (isGood) {
                // ã‚°ãƒƒãƒ‰ã‚­ãƒ£ãƒ©ã‚’ã‚¯ãƒªãƒƒã‚¯: åŠ ç‚¹
                score += 10;
                // ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
                targetChar.textContent = 'âœ…';
            } else {
                // ãƒãƒƒãƒ‰ã‚­ãƒ£ãƒ©ã‚’ã‚¯ãƒªãƒƒã‚¯: æ¸›ç‚¹
                score -= 15; // æ¸›ç‚¹å¹…ã‚’å¤§ããã—ã¦é›£æ˜“åº¦ã‚¢ãƒƒãƒ—
                // ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
                targetChar.textContent = 'âŒ';
                // ã‚¹ã‚³ã‚¢ãŒãƒã‚¤ãƒŠã‚¹ã«ãªã‚‰ãªã„ã‚ˆã†ã«ä¸‹é™ã‚’è¨­å®š
                if (score < 0) score = 0;
            }

            scoreDisplay.textContent = `ã‚¹ã‚³ã‚¢: ${score}`;

            // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’å‰Šé™¤
            targetChar.removeEventListener('click', handleCharacterClick);
            targetChar.style.transition = 'none'; // å³åº§ã«æ¶ˆã™ãŸã‚ã®æº–å‚™
            setTimeout(() => {
                targetChar.remove();
            }, 100); // å°‘ã—é…å»¶ã•ã›ã¦ã€ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆâœ…/âŒï¼‰ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹
        }

        /**
         * ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã™ã‚‹
         */
        function startGame() {
            if (gameActive) return;

            // æ—¢å­˜ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’ã™ã¹ã¦å‰Šé™¤
            gameArea.innerHTML = '';

            // çŠ¶æ…‹ã®åˆæœŸåŒ–
            gameActive = true;
            score = 0;
            timeLeft = GAME_DURATION;
            scoreDisplay.textContent = 'ã‚¹ã‚³ã‚¢: 0';
            startButton.disabled = true;

            // 0.01ç§’ã”ã¨ã«ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ã‚’å®Ÿè¡Œ
            timerInterval = setInterval(countdown, 10); 
            
            // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®ç”Ÿæˆã‚’é–‹å§‹
            spawnInterval = setInterval(spawnCharacter, SPAWN_INTERVAL);
        }

        /**
         * ã‚²ãƒ¼ãƒ ã‚’çµ‚äº†ã™ã‚‹
         */
        function endGame() {
            gameActive = false;
            clearInterval(timerInterval);
            clearInterval(spawnInterval);
            
            // ã™ã¹ã¦ã®ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚’å‰Šé™¤
            gameArea.innerHTML = '';
            
            const finalMessage = document.createElement('div');
            finalMessage.className = 'character good'; // è¦‹ãŸç›®ã ã‘æ‹å€Ÿ
            finalMessage.style.position = 'absolute';
            finalMessage.style.left = '50%';
            finalMessage.style.top = '50%';
            finalMessage.style.transform = 'translate(-50%, -50%)';
            finalMessage.style.backgroundColor = '#ff6347';
            finalMessage.style.width = 'auto';
            finalMessage.style.height = 'auto';
            finalMessage.style.padding = '20px';
            finalMessage.style.borderRadius = '10px';
            finalMessage.textContent = `æœ€çµ‚ã‚¹ã‚³ã‚¢: ${score}ç‚¹ï¼`;
            finalMessage.style.fontSize = '2em';
            finalMessage.style.cursor = 'default';

            gameArea.appendChild(finalMessage);
            
            startButton.textContent = 'ã‚‚ã†ä¸€åº¦ãƒ—ãƒ¬ã‚¤';
            startButton.disabled = false;

            alert(`ã‚²ãƒ¼ãƒ çµ‚äº†ï¼ã‚ãªãŸã®æœ€çµ‚ã‚¹ã‚³ã‚¢ã¯ ${score} ç‚¹ã§ã™ï¼`);
        }

        // ------------------
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        // ------------------

        startButton.addEventListener('click', startGame);

        // åˆæœŸè¡¨ç¤ºã‚’æ›´æ–°
        timerDisplay.textContent = `æ®‹ã‚Šæ™‚é–“: ${GAME_DURATION.toFixed(2)}ç§’`;
    </script>
</body>
</html>
